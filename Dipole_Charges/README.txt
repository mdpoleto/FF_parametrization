This file explains how the dipole-charges derivation is done.

######### CREATING QM CHARGES #############################################
1- Run your QM calculation (MP2/6-31G - ESP) in your software of choice.


######### CREATING SUITABLE INPUT #########################################
2- Translate the obtained charges to a .mol2 file. It is important that the "@<TRIPOS>ATOM" line
   starts at line #8 of the .mol2 file. NOTE: your .mol2 file should be named "example-esp.mol2"
   (the "example" part can be modified).

   Note that atomic charges placed in a cartesian space will generate a dipole moment vector. Since
   the atomic charges and coordinates were generated from a QM calculation, this "example-esp.mol2"
   will carry a QM dipole moment vector. Its direction will be a reference for this protocol.


######### DEFINING CHARGE UPPER AND LOWER BOUNDARIES ######################
3- Run "python write_csv.py example-esp.mol2" to obtain a "example.csv" file that will carry the charge boundaries.


   This protocol is based on lower and upper boundaries for atomic charges, in a way that the solution
   generated by our protocol preserves the dipole moment direction.

   This means that at each line, the two last columns in the .csv files are the lower and upper boundaries.

    ID            Atom                            X coord       Y coord        Z coord       QM charge       Lower          Upper     
     1,             C,             0,             -4.7584,       0.4116,        -0.2313,       0.0477,        -1.00,          1.00            
     2,             H,             0,             -6.1029,       2.1354,        -0.1405,       0.0287,        -1.00,          1.00            
     3,             O,             0,             -3.4992,       0.0043,         0.2795,      -0.3798,        -1.00,          1.00            

   So the user should alter the lower and upper boundaries that the algorithm should use to generate a solution.

   In general, non-polar carbons vary from -0.20 to +0.20. Oxygens and Nitrogens upper limit is -0.20. Hydrogens
   are always positive (lower limit of +0.00). Of course this is only my experience and can be altered if the user
   is certain of what he is doing. 

   This is the place you should enter previously calibrated group charges. For example: benzenic C-H groups have 
   -0.13 and +0.13 charge, respectivelly. Thus, the upper and lower limits will be equal, so the algorithm will
   not have any room to change it. If that is the case for the example above, it should be become:

    ID            Atom                            X coord       Y coord        Z coord       QM charge       Lower          Upper     
     1,             C,             0,             -4.7584,       0.4116,        -0.2313,       0.0477,        -0.13,         -0.13            
     2,             H,             0,             -6.1029,       2.1354,        -0.1405,       0.0287,         0.13,          0.13            
     3,             O,             0,             -3.4992,       0.0043,         0.2795,      -0.3798,        -0.80,         -0.20   



######### OBTAINING NEW SET OF CHARGES BASED ON DIPOLE MOMENT #############
4- Run "python getvector.py example.csv example-esp.mol2 Q C", with Q = the magnitude of the dipole moment generated 
   (as a fraction of 1, e.g. 1.0 is 100%) and C = the total net charge of the molecule (0 for neutral molecules)

   Example: "python getvector.py example.csv example-esp.mol2 0.7 0.0" to obtain a new distribution of charges that 
   sums 0 and, when applied to the coordinates from the .mol2 file, will generate a new dipole moment with the same 
   direction of the QM, with 70% of its magnitude.

   This step will generate a "example-lsql.mol2" file. It contains the same coordinates as the "example-esp.mol2", 
   but with a new set of atomic charges.

   Please check if the boundaries were respected!!!! If the boundaries defined on your .csv is too restrict, it is 
   more likely that they will be violated. If that is the case, try other boundaries.

   A good output will respect the defined boundaries and the change in magnitude required.

   TIP: open both .mol2 files in VMD and visualize them using the Dipole Moment Watcher! 
